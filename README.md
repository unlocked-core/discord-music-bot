# Discord Музыкальный Бот

Простой и безопасный Discord бот для воспроизведения музыки с YouTube.

## Возможности

- Воспроизведение музыки с YouTube по URL
- Система очередей для треков
- Базовые команды управления (play, skip, stop, queue)
- Автоматическое отключение при пустой очереди
- Обработка ошибок и безопасная архитектура

## Требования

- Node.js версии 16.0.0 или выше
- FFmpeg (устанавливается автоматически через ffmpeg-static)
- Discord бот токен

## Установка

1. Клонируйте или скачайте проект
2. Установите зависимости:

```bash
npm install
```

3. Создайте файл `.env` на основе `.env.example`:

```bash
cp .env.example .env
```

4. Получите токен Discord бота:

   - Перейдите на https://discord.com/developers/applications
   - Создайте новое приложение
   - Перейдите в раздел "Bot"
   - **ВАЖНО:** Включите следующие привилегированные интенты:
     - `Message Content Intent` (обязательно)
     - `Server Members Intent` (рекомендуется)
   - Скопируйте токен и вставьте в файл `.env`

5. Пригласите бота на сервер:
   - В разделе "OAuth2" → "URL Generator"
   - Выберите scope: `bot`
   - Выберите permissions:
     - `Send Messages` (отправка сообщений)
     - `Connect` (подключение к голосовым каналам)
     - `Speak` (воспроизведение звука)
     - `Use Voice Activity` (использование голосовой активности)
   - Скопируйте сгенерированную ссылку
   - Откройте ссылку в браузере и выберите сервер для добавления бота
   - Подтвердите права доступа

## Запуск

```bash
npm start
```

Для разработки с автоперезагрузкой:

```bash
npm run dev
```

## Команды

| Команда                      | Описание                          |
| ---------------------------- | --------------------------------- |
| `!play <URL>` или `!p <URL>` | Добавить трек в очередь           |
| `!skip` или `!s`             | Пропустить текущий трек           |
| `!stop`                      | Остановить и очистить очередь     |
| `!queue` или `!q`            | Показать очередь                  |
| `!help` или `!h`             | Показать команды (красивый embed) |

## Безопасность

- Валидация URL YouTube
- Обработка ошибок на всех уровнях
- Автоматическая очистка ресурсов
- Проверка прав пользователя (нахождение в голосовом канале)

## Структура проекта

```
discord-music-bot/
├── index.js          # Основной файл бота
├── package.json      # Зависимости и скрипты
├── .env.example      # Пример файла конфигурации
└── README.md         # Документация
```

## Устранение неполадок

### Бот не подключается

- Проверьте правильность токена в файле `.env`
- Убедитесь, что бот приглашен на сервер с нужными правами

### Ошибки воспроизведения

- Убедитесь, что URL YouTube корректный и видео доступно
- Проверьте подключение к интернету
- Некоторые видео могут быть заблокированы для воспроизведения

### Проблемы с голосовым каналом

- Убедитесь, что вы находитесь в голосовом канале
- Проверьте права бота на подключение к голосовым каналам

### Предупреждения в редакторе

- Предупреждение о схеме JSON в package.json можно игнорировать - это не влияет на работу бота
- Предупреждения о deprecated версиях @discordjs/voice не критичны для функциональности

## Лицензия

MIT License
